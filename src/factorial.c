/* This file is part of AFMM, an axisymmetric Fast Multipole Method code
 *
 * Copyright (C) 2022 Michael Carley
 *
 * WBFMM is free software: you can redistribute it and/or modify it
 * under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.  WBFMM is distributed in the
 * hope that it will be useful, but WITHOUT ANY WARRANTY; without even
 * the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 * PURPOSE.  See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with WBFMM.  If not, see <https://www.gnu.org/licenses/>.
 */

#include <glib.h>

#include "afmm-private.h"

#if 0
gdouble afmm_binomial(guint n, guint k)
/* https://stackoverflow.com/questions/9619743/how-to-calculate-binomial-coefficents-for-large-numbers */
{
  if (k > n) return 0 ;

  gdouble c = n;
  for ( guint i = 1; i < k; i ++ ) {
    c *= n - i ;
    c /= i + 1 ;
  }

  return c;
}
#endif

const gdouble AFMM_FACTORIALS[] = {
  1.0000000000000000e+00, 1.0000000000000000e+00, 2.0000000000000000e+00,
  6.0000000000000000e+00, 2.4000000000000000e+01, 1.2000000000000000e+02,
  7.2000000000000000e+02, 5.0400000000000000e+03, 4.0320000000000000e+04,
  3.6288000000000000e+05, 3.6288000000000084e+06, 3.9916800000000030e+07,
  4.7900159999999928e+08, 6.2270207999999657e+09, 8.7178291200000168e+10,
  1.3076743679999983e+12, 2.0922789887999980e+13, 3.5568742809599812e+14,
  6.4023737057279940e+15, 1.2164510040883208e+17, 2.4329020081766400e+18,
  5.1090942171709784e+19, 1.1240007277776035e+21, 2.5852016738885062e+22,
  6.2044840173323914e+23, 1.5511210043331066e+25, 4.0329146112660538e+26,
  1.0888869450418268e+28, 3.0488834461171542e+29, 8.8417619937396265e+30,
  2.6525285981218941e+32, 8.2228386541778936e+33, 2.6313083693369503e+35,
  8.6833176188119946e+36, 2.9523279903960499e+38, 1.0333147966386149e+40,
  3.7199332678990102e+41, 1.3763753091226160e+43, 5.2302261746659953e+44,
  2.0397882081197180e+46, 8.1591528324790563e+47, 3.3452526613163927e+49,
  1.4050061177528771e+51, 6.0415263063373260e+52, 2.6582715747884193e+54,
  1.1962222086548034e+56, 5.5026221598119888e+57, 2.5862324151117192e+59,
  1.2413915592535963e+61, 6.0828186403425592e+62, 3.0414093201713019e+64,
  1.5511187532873646e+66, 8.0658175170944942e+67, 4.2748832840601228e+69,
  2.3084369733924540e+71, 1.2696403353658287e+73, 7.1099858780487453e+74,
  4.0526919504876951e+76, 2.3505613312829024e+78, 1.3868311854568818e+80,
  8.3209871127414438e+81, 5.0758021387722225e+83, 3.1469973260387477e+85,
  1.9826083154044198e+87, 1.2688693218588428e+89, 8.2476505920820880e+90,
  5.4434493907743010e+92, 3.6471110918189461e+94, 2.4800355424368993e+96,
  1.7112245242814200e+98, 1.1978571669969933e+100, 8.5047858856785845e+101,
  6.1234458376885870e+103, 4.4701154615127710e+105, 3.3078854415192728e+107,
  2.4809140811395329e+109, 1.8854947016660685e+111, 1.4518309202828782e+113,
  1.1324281178206039e+115, 8.9461821307828735e+116, 7.1569457046266771e+118,
  5.7971260207475536e+120, 4.7536433370131092e+122, 3.9455239697206508e+124,
  3.3142401345654752e+126, 2.8171041143804693e+128, 2.4227095383671897e+130,
  2.1077572983796612e+132, 1.8548264225740497e+134, 1.6507955160908248e+136,
  1.4857159644817212e+138, 1.3520015276784450e+140, 1.2438414054641828e+142,
  1.1567725070816412e+144, 1.0873661566567803e+146, 1.0329978488238504e+148,
  9.9167793487095964e+149, 9.6192759682489238e+151, 9.4268904488835978e+153,
  9.3326215443949336e+155, 9.3326215443942249e+157
} ;

const gfloat AFMM_FACTORIALS_F[] = {
  1.0000000000000000e+00, 1.0000000000000000e+00, 2.0000000000000000e+00,
  6.0000000000000000e+00, 2.4000000000000000e+01, 1.2000000000000000e+02,
  7.2000000000000000e+02, 5.0400000000000000e+03, 4.0320000000000000e+04,
  3.6288000000000000e+05, 3.6288000000000084e+06, 3.9916800000000030e+07,
  4.7900159999999928e+08, 6.2270207999999657e+09, 8.7178291200000168e+10,
  1.3076743679999983e+12, 2.0922789887999980e+13, 3.5568742809599812e+14,
  6.4023737057279940e+15, 1.2164510040883208e+17, 2.4329020081766400e+18,
  5.1090942171709784e+19, 1.1240007277776035e+21, 2.5852016738885062e+22,
  6.2044840173323914e+23, 1.5511210043331066e+25, 4.0329146112660538e+26,
  1.0888869450418268e+28, 3.0488834461171542e+29, 8.8417619937396265e+30,
  2.6525285981218941e+32, 8.2228386541778936e+33, 2.6313083693369503e+35,
  8.6833176188119946e+36, 2.9523279903960499e+38, 1.0333147966386149e+40,
  3.7199332678990102e+41, 1.3763753091226160e+43, 5.2302261746659953e+44,
  2.0397882081197180e+46, 8.1591528324790563e+47, 3.3452526613163927e+49,
  1.4050061177528771e+51, 6.0415263063373260e+52, 2.6582715747884193e+54,
  1.1962222086548034e+56, 5.5026221598119888e+57, 2.5862324151117192e+59,
  1.2413915592535963e+61, 6.0828186403425592e+62, 3.0414093201713019e+64,
  1.5511187532873646e+66, 8.0658175170944942e+67, 4.2748832840601228e+69,
  2.3084369733924540e+71, 1.2696403353658287e+73, 7.1099858780487453e+74,
  4.0526919504876951e+76, 2.3505613312829024e+78, 1.3868311854568818e+80,
  8.3209871127414438e+81, 5.0758021387722225e+83, 3.1469973260387477e+85,
  1.9826083154044198e+87, 1.2688693218588428e+89, 8.2476505920820880e+90,
  5.4434493907743010e+92, 3.6471110918189461e+94, 2.4800355424368993e+96,
  1.7112245242814200e+98, 1.1978571669969933e+100, 8.5047858856785845e+101,
  6.1234458376885870e+103, 4.4701154615127710e+105, 3.3078854415192728e+107,
  2.4809140811395329e+109, 1.8854947016660685e+111, 1.4518309202828782e+113,
  1.1324281178206039e+115, 8.9461821307828735e+116, 7.1569457046266771e+118,
  5.7971260207475536e+120, 4.7536433370131092e+122, 3.9455239697206508e+124,
  3.3142401345654752e+126, 2.8171041143804693e+128, 2.4227095383671897e+130,
  2.1077572983796612e+132, 1.8548264225740497e+134, 1.6507955160908248e+136,
  1.4857159644817212e+138, 1.3520015276784450e+140, 1.2438414054641828e+142,
  1.1567725070816412e+144, 1.0873661566567803e+146, 1.0329978488238504e+148,
  9.9167793487095964e+149, 9.6192759682489238e+151, 9.4268904488835978e+153,
  9.3326215443949336e+155, 9.3326215443942249e+157
} ;

const gint AFMM_BINOMIALS[] = {
  1,
  1, 1,
  1, 2,  1,
  1, 3,  3,  1,
  1, 4,  6,  4,   1,
  1, 5, 10, 10,   5,   1,
  1, 6, 15, 20,  15,   6,   1,
  1, 7, 21, 35,  35,  21,   7,    1,
  1, 8, 28, 56,  70,  56,  28,    8,    1,
  1, 9, 36, 84, 126, 126,  84,   36,    9,    1,
  1,10, 45,120, 210, 252, 210,  120,   45,   10,   1,
  1,11, 55,165, 330, 462, 462,  330,  165,   55,  11,   1,
  1,12, 66,220, 495, 792, 924,  792,  495,  220,  66,  12,   1,
  1,13, 78,286, 715,1287,1716, 1716, 1287,  715, 286,  78,  13,  1,
  1,14, 91,364,1001,2002,3003, 3432, 3003, 2002,1001, 364,  91, 14,  1,
  1,15,105,455,1365,3003,5005, 6435, 6435, 5005,3003,1365, 455,105, 15, 1,
  1,16,120,560,1820,4368,8008,11440,12870,11440,8008,4368,1820,560,120,16,1,
  1,17,136,680,2380,6188,12376,19448,24310,24310,19448,12376,6188,2380,680,136,17,1,
  1,18,153,816,3060,8568,18564,31824,43758,48620,43758,31824,18564,8568,3060,816,153,18,1,
  1,19,171,969,3876,11628,27132,50388,75582,92378,92378,75582,50388,27132,11628,3876,969,171,19,1,
  1,20,190,1140,4845,15504,38760,77520,125970,167960,184756,167960,125970,77520,38760,15504,4845,1140,190,20,1,
  1,21,210,1330,5985,20349,54264,116280,203490,293930,352716,352716,293930,203490,116280,54264,20349,5985,1330,210,21,1,
  1,22,231,1540,7315,26334,74613,170544,319770,497420,646646,705432,646646,497420,319770,170544,74613,26334,7315,1540,231,22,1,
  1,23,253,1771,8855,33649,100947,245157,490314,817190,1144066,1352078,1352078,1144066,817190,490314,245157,100947,33649,8855,1771,253,23,1,
  1,24,276,2024,10626,42504,134596,346104,735471,1307504,1961256,2496144,2704156,2496144,1961256,1307504,735471,346104,134596,42504,10626,2024,276,24,1,
  1,25,300,2300,12650,53130,177100,480700,1081575,2042975,3268760,4457400,5200300,5200300,4457400,3268760,2042975,1081575,480700,177100,53130,12650,2300,300,25,1,
  1,26,325,2600,14950,65780,230230,657800,1562275,3124550,5311735,7726160,9657700,10400600,9657700,7726160,5311735,3124550,1562275,657800,230230,65780,14950,2600,325,26,1,
  1,27,351,2925,17550,80730,296010,888030,2220075,4686825,8436285,13037895,17383860,20058300,20058300,17383860,13037895,8436285,4686825,2220075,888030,296010,80730,17550,2925,351,27,1,
  1,28,378,3276,20475,98280,376740,1184040,3108105,6906900,13123110,21474180,30421755,37442160,40116600,37442160,30421755,21474180,13123110,6906900,3108105,1184040,376740,98280,20475,3276,378,28,1,
  1,29,406,3654,23751,118755,475020,1560780,4292145,10015005,20030010,34597290,51895935,67863915,77558760,77558760,67863915,51895935,34597290,20030010,10015005,4292145,1560780,475020,118755,23751,3654,406,29,1,
  1,30,435,4060,27405,142506,593775,2035800,5852925,14307150,30045015,54627300,86493225,119759850,145422675,155117520,145422675,119759850,86493225,54627300,30045015,14307150,5852925,2035800,593775,142506,27405,4060,435,30,1,
  1,31,465,4495,31465,169911,736281,2629575,7888725,20160075,44352165,84672315,141120525,206253075,265182525,300540195,300540195,265182525,206253075,141120525,84672315,44352165,20160075,7888725,2629575,736281,169911,31465,4495,465,31,1,
  1,32,496,4960,35960,201376,906192,3365856,10518300,28048800,64512240,129024480,225792840,347373600,471435600,565722720,601080390,565722720,471435600,347373600,225792840,129024480,64512240,28048800,10518300,3365856,906192,201376,35960,4960,496,32,1,
  1,33,528,5456,40920,237336,1107568,4272048,13884156,38567100,92561040,193536720,354817320,573166440,818809200,1037158320,1166803110,1166803110,1037158320,818809200,573166440,354817320,193536720,92561040,38567100,13884156,4272048,1107568,237336,40920,5456,528,33,1
} ;

const gdouble AFMM_N_SQUARED[] = {
  0.000000, 1.000000, 4.000000, 9.000000, 16.000000, 25.000000, 36.000000, 49.000000, 64.000000, 81.000000, 100.000000, 121.000000, 144.000000, 169.000000, 196.000000, 225.000000, 256.000000, 289.000000, 324.000000, 361.000000, 400.000000, 441.000000, 484.000000, 529.000000, 576.000000, 625.000000, 676.000000, 729.000000, 784.000000, 841.000000, 900.000000, 961.000000, 1024.000000, 1089.000000, 1156.000000, 1225.000000, 1296.000000, 1369.000000, 1444.000000, 1521.000000, 1600.000000, 1681.000000, 1764.000000, 1849.000000, 1936.000000, 2025.000000, 2116.000000, 2209.000000, 2304.000000, 2401.000000, 2500.000000, 2601.000000, 2704.000000, 2809.000000, 2916.000000, 3025.000000, 3136.000000, 3249.000000, 3364.000000, 3481.000000, 3600.000000, 3721.000000, 3844.000000, 3969.000000, 4096.000000, 4225.000000, 4356.000000, 4489.000000, 4624.000000, 4761.000000, 4900.000000, 5041.000000, 5184.000000, 5329.000000, 5476.000000, 5625.000000, 5776.000000, 5929.000000, 6084.000000, 6241.000000, 6400.000000, 6561.000000, 6724.000000, 6889.000000, 7056.000000, 7225.000000, 7396.000000, 7569.000000, 7744.000000, 7921.000000, 8100.000000, 8281.000000, 8464.000000, 8649.000000, 8836.000000, 9025.000000, 9216.000000, 9409.000000, 9604.000000, 9801.000000, 10000.000000, 10201.000000, 10404.000000, 10609.000000, 10816.000000, 11025.000000, 11236.000000, 11449.000000, 11664.000000, 11881.000000, 12100.000000, 12321.000000, 12544.000000, 12769.000000, 12996.000000, 13225.000000, 13456.000000, 13689.000000, 13924.000000, 14161.000000, 14400.000000, 14641.000000, 14884.000000, 15129.000000, 15376.000000, 15625.000000, 15876.000000, 16129.000000, 16384.000000, 16641.000000, 16900.000000, 17161.000000, 17424.000000, 17689.000000, 17956.000000, 18225.000000, 18496.000000, 18769.000000, 19044.000000, 19321.000000, 19600.000000, 19881.000000, 20164.000000, 20449.000000, 20736.000000, 21025.000000, 21316.000000, 21609.000000, 21904.000000, 22201.000000, 22500.000000, 22801.000000, 23104.000000, 23409.000000, 23716.000000, 24025.000000, 24336.000000, 24649.000000, 24964.000000, 25281.000000, 25600.000000, 25921.000000, 26244.000000, 26569.000000, 26896.000000, 27225.000000, 27556.000000, 27889.000000, 28224.000000, 28561.000000, 28900.000000, 29241.000000, 29584.000000, 29929.000000, 30276.000000, 30625.000000, 30976.000000, 31329.000000, 31684.000000, 32041.000000, 32400.000000, 32761.000000, 33124.000000, 33489.000000, 33856.000000, 34225.000000, 34596.000000, 34969.000000, 35344.000000, 35721.000000, 36100.000000, 36481.000000, 36864.000000, 37249.000000, 37636.000000, 38025.000000, 38416.000000, 38809.000000, 39204.000000, 39601.000000, 40000.000000, 40401.000000, 40804.000000, 41209.000000, 41616.000000, 42025.000000, 42436.000000, 42849.000000, 43264.000000, 43681.000000, 44100.000000, 44521.000000, 44944.000000, 45369.000000, 45796.000000, 46225.000000, 46656.000000, 47089.000000, 47524.000000, 47961.000000, 48400.000000, 48841.000000, 49284.000000, 49729.000000, 50176.000000, 50625.000000, 51076.000000, 51529.000000, 51984.000000, 52441.000000, 52900.000000, 53361.000000, 53824.000000, 54289.000000, 54756.000000, 55225.000000, 55696.000000, 56169.000000, 56644.000000, 57121.000000, 57600.000000, 58081.000000, 58564.000000, 59049.000000, 59536.000000, 60025.000000, 60516.000000, 61009.000000, 61504.000000, 62001.000000, 62500.000000, 63001.000000, 63504.000000, 64009.000000, 64516.000000, 65025.000000, 65536.000000} ;

const gfloat AFMM_N_SQUARED_F[] = {
  0.000000, 1.000000, 4.000000, 9.000000, 16.000000, 25.000000, 36.000000, 49.000000, 64.000000, 81.000000, 100.000000, 121.000000, 144.000000, 169.000000, 196.000000, 225.000000, 256.000000, 289.000000, 324.000000, 361.000000, 400.000000, 441.000000, 484.000000, 529.000000, 576.000000, 625.000000, 676.000000, 729.000000, 784.000000, 841.000000, 900.000000, 961.000000, 1024.000000, 1089.000000, 1156.000000, 1225.000000, 1296.000000, 1369.000000, 1444.000000, 1521.000000, 1600.000000, 1681.000000, 1764.000000, 1849.000000, 1936.000000, 2025.000000, 2116.000000, 2209.000000, 2304.000000, 2401.000000, 2500.000000, 2601.000000, 2704.000000, 2809.000000, 2916.000000, 3025.000000, 3136.000000, 3249.000000, 3364.000000, 3481.000000, 3600.000000, 3721.000000, 3844.000000, 3969.000000, 4096.000000, 4225.000000, 4356.000000, 4489.000000, 4624.000000, 4761.000000, 4900.000000, 5041.000000, 5184.000000, 5329.000000, 5476.000000, 5625.000000, 5776.000000, 5929.000000, 6084.000000, 6241.000000, 6400.000000, 6561.000000, 6724.000000, 6889.000000, 7056.000000, 7225.000000, 7396.000000, 7569.000000, 7744.000000, 7921.000000, 8100.000000, 8281.000000, 8464.000000, 8649.000000, 8836.000000, 9025.000000, 9216.000000, 9409.000000, 9604.000000, 9801.000000, 10000.000000, 10201.000000, 10404.000000, 10609.000000, 10816.000000, 11025.000000, 11236.000000, 11449.000000, 11664.000000, 11881.000000, 12100.000000, 12321.000000, 12544.000000, 12769.000000, 12996.000000, 13225.000000, 13456.000000, 13689.000000, 13924.000000, 14161.000000, 14400.000000, 14641.000000, 14884.000000, 15129.000000, 15376.000000, 15625.000000, 15876.000000, 16129.000000, 16384.000000, 16641.000000, 16900.000000, 17161.000000, 17424.000000, 17689.000000, 17956.000000, 18225.000000, 18496.000000, 18769.000000, 19044.000000, 19321.000000, 19600.000000, 19881.000000, 20164.000000, 20449.000000, 20736.000000, 21025.000000, 21316.000000, 21609.000000, 21904.000000, 22201.000000, 22500.000000, 22801.000000, 23104.000000, 23409.000000, 23716.000000, 24025.000000, 24336.000000, 24649.000000, 24964.000000, 25281.000000, 25600.000000, 25921.000000, 26244.000000, 26569.000000, 26896.000000, 27225.000000, 27556.000000, 27889.000000, 28224.000000, 28561.000000, 28900.000000, 29241.000000, 29584.000000, 29929.000000, 30276.000000, 30625.000000, 30976.000000, 31329.000000, 31684.000000, 32041.000000, 32400.000000, 32761.000000, 33124.000000, 33489.000000, 33856.000000, 34225.000000, 34596.000000, 34969.000000, 35344.000000, 35721.000000, 36100.000000, 36481.000000, 36864.000000, 37249.000000, 37636.000000, 38025.000000, 38416.000000, 38809.000000, 39204.000000, 39601.000000, 40000.000000, 40401.000000, 40804.000000, 41209.000000, 41616.000000, 42025.000000, 42436.000000, 42849.000000, 43264.000000, 43681.000000, 44100.000000, 44521.000000, 44944.000000, 45369.000000, 45796.000000, 46225.000000, 46656.000000, 47089.000000, 47524.000000, 47961.000000, 48400.000000, 48841.000000, 49284.000000, 49729.000000, 50176.000000, 50625.000000, 51076.000000, 51529.000000, 51984.000000, 52441.000000, 52900.000000, 53361.000000, 53824.000000, 54289.000000, 54756.000000, 55225.000000, 55696.000000, 56169.000000, 56644.000000, 57121.000000, 57600.000000, 58081.000000, 58564.000000, 59049.000000, 59536.000000, 60025.000000, 60516.000000, 61009.000000, 61504.000000, 62001.000000, 62500.000000, 63001.000000, 63504.000000, 64009.000000, 64516.000000, 65025.000000, 65536.000000} ;
